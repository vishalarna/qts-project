
<ng-container>
    <div class="flex flex-col">
    <div class="flex flex-row justify-between items-center px-12 mt-5">
      <p class="text-xl font-bold text-gray-900">{{"Enroll Employee"}}
      </p>
      <app-icon (click)="closeFlyPanel()" class="cursor-pointer" icon="close"></app-icon>
    </div>
</div>

  <div class="items-center px-12 mt-5">
    <div class="flex flex-row mat-elevation-z3 px-2 py-3">
    <span>
        {{selectedIDPvm.ilaNumber}}
    </span>
    <span class="ml-4">
      {{selectedIDPvm.ilaTitle}}

    </span>
    </div>
    <div class="mt-4">
        <div class="mt-3 flex flex-col">
            <div>
                <app-label text="Current and Upcoming Class Schedule"></app-label>
            </div>
            <div class="flex flex-row justify-between">
                <span class="text-gray-400" style="width: 17rem;">Choose your desired slot below or create a new schedule to enroll {{("Employee" | labelReplacement)| async}}</span>
            <div>
                <app-button text="Create New Schedule" color="secondary" (click)="RedirectToSchedule()" size="sm"></app-button>
            </div>
            </div>
        </div>
        <div class="mt-3">
          <app-spinner  *ngIf="showSpinner"></app-spinner>
            <table *ngIf="!showSpinner" [dataSource]="upComingClassesDataSource" matSort mat-table class="w-full mat-elevation-z3 px-2 py-3" #upcomingSort="matSort">
                <ng-container matColumnDef="startDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Date</th>
                  <td mat-cell *matCellDef="let row">{{row.startDate == null ? 'N/A' : (row.startDate | dateFormat )| async}}</td>
                </ng-container>
                <ng-container matColumnDef="endDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>End Date </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.endDate == null ? 'N/A' : (row.endDate | dateFormat )| async}}
                  </td>
                </ng-container>
                <ng-container matColumnDef="location">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>{{("Location" | labelReplacement)| async}}s</th>
                  <td mat-cell *matCellDef="let row">
                    {{ row.location }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header style="width:10%;"></th>
                    <td mat-cell *matCellDef="let row">
                      <app-button *ngIf="row.isEnrolled" text="Unenroll" size="sm" (click)="selectedclassiTem=row;openDeleteDialog(deleteDialog)"></app-button>
                      <app-button  *ngIf="!row.isEnrolled" color="secondary" text="Enroll" size="sm" (click)="selectedclassId=row.classScheduleId;startDate=row.startDate;OpenPlannedDateModal(plannedDate);isPastClass = false"></app-button>
                    </td>
                  </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

                <!-- Row shown when there is no matching data.-->
                <tr class="mat-row flex text-center" *matNoDataRow>
                  <td class="td w-full m-2">No data to display</td>
                </tr>
              </table>
              <!-- <mat-paginator
                [pageSizeOptions]="[20, 40, 60]"
                showFirstLastButtons
                aria-label="Select page of periodic elements"
              >
              </mat-paginator> -->
              <div class="pt-5 pb-2">
                <app-label text = "Past Classes" class="font-weight-bold text-xl"></app-label>
              </div>

              <table *ngIf="!showSpinner" [dataSource]="pastClassesDataSource" matSort mat-table class="w-full mat-elevation-z3 px-2 py-3" #pastSort="matSort">
                <ng-container matColumnDef="startDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Date</th>
                  <td mat-cell *matCellDef="let row">{{row.startDate == null ? 'N/A' : (row.startDate | dateFormat )| async}}</td>
                </ng-container>
                <ng-container matColumnDef="endDate">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>End Date </th>
                  <td mat-cell *matCellDef="let row">
                    {{row.endDate == null ? 'N/A' : (row.endDate | dateFormat )| async}}
                  </td>
                </ng-container>
                <ng-container matColumnDef="location">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>{{("Location" | labelReplacement)| async}}s</th>
                  <td mat-cell *matCellDef="let row">
                    {{ row.location }}
                  </td>
                </ng-container>
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header style="width:10%;"></th>
                    <td mat-cell *matCellDef="let row">
                      <app-button *ngIf="row.isEnrolled" text="Unenroll" size="sm" (click)="selectedclassiTem=row;openDeleteDialog(deleteDialog)"></app-button>
                      <app-button  *ngIf="!row.isEnrolled" color="secondary" text="Enroll" size="sm" (click)="selectedclassId=row.classScheduleId;startDate=row.startDate;OpenPlannedDateModal(plannedDate);isPastClass = true;"></app-button>
                    </td>
                  </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

                <!-- Row shown when there is no matching data.-->
                <tr class="mat-row flex text-center" *matNoDataRow>
                  <td class="td w-full m-2">No data to display</td>
                </tr>
              </table>
        </div>
    </div>
</div>



  </ng-container>
  <ng-template #plannedDate>
    <app-planned-date-dialogue
    [showEffectiveDateAndReason]="true"
    [EmployeeName]="EmployeeName"
    [IlaName]="ilaName"
    [DateStart]="startDate"
    (canceled)="dialog.closeAll()"
    (confirmed)="SavePlannedDate($event)"
    [isPastClass] = "isPastClass"
    >
  </app-planned-date-dialogue>

  </ng-template>

  <ng-template #SelectNewEnrollments>
    <app-enrollment-date-dialogue
    [selectedClassitem]="selectedclassiTem"
    (canceled)="dialog.closeAll()"
    (confirmed)="UpdateEnrolledDate($event)"
    >
  </app-enrollment-date-dialogue>

  </ng-template>
  <ng-template #deleteDialog>
    <app-qtd-dialogue [header]="dialogTitle" [description]="dialogDesc" cancelText="No" confirmText="Yes"
        [isQuestion] = "false"  (canceled)="dialog.closeAll()" (confirmed)="UnEnrollEmployee()">
    </app-qtd-dialogue>
</ng-template>
