<div [hidden]="filterPanelEMP || filterPanelTask || filterPanelOrg || filterPanelSkill" class="flex flex-col w-full p-5">
  <div class="flex flex-row justify-between mb-4">
    <span class="text-xl font-bold">Release {{("Task" | labelReplacement)| async}} & Skill Qualification By {{("Employee" | labelReplacement)| async}}</span>
    <app-icon icon="close" class="text-gray-500 cursor-pointer" (click)="closed.emit()"></app-icon>
  </div>
  <mat-stepper (selectionChange)="stepChange($event)" linear #stepper labelPosition="bottom"
    [orientation]="(stepperOrientation | async)!">
    <ng-template matStepperIcon="edit">
      <app-icon icon="done"></app-icon>
    </ng-template>
    <mat-step [completed]="empSelection.selected.length > 0" label="Select {{('Employee' | labelReplacement)| async}}">
      <div class="flex flex-col w-full">
        <div class="flex flex-row items-center mt-3 justify-between" style="align-items:baseline;">
          <!-- Search Field for EMP -->
          <div class="flex flex-col" style="width: 70%;">
            <div class="flex border-b-0.8 border-gray-one pr-4 pb-3">
              <app-icon icon="search"></app-icon>
              <input (input)="filterEMP()" class="text-sm flex-grow focus:outline-none" placeholder="Search" type="text"
                [(ngModel)]="filterEMPString">
            </div>
            <!-- <div class="mt-3 mb-3">
              <span class="text-gray-400">Showing: {{filterActiveEMP ? "Active" : "Inactive"}} Employees
                <app-icon [mat-menu-trigger-for]="empFilter" class="text-gray-400 cursor-pointer"
                  icon="keyboard_arrow_down"></app-icon>
              </span>
              <mat-menu #empFilter="matMenu" backdropClass="qtd__menu">
                <label (click)="filterActiveEMP = true" *ngIf="!filterActiveEMP" mat-menu-item>Active</label>
                <label (click)="filterActiveEMP = false" *ngIf="filterActiveEMP" mat-menu-item>Inactive</label>
              </mat-menu>
            </div> -->
          </div>
          <div class="flex flex-row mb-3 ml-2">
            <app-button [customClasses]="'pl-2 pr-2'" type="button" color="secondary" size="sm" leftIcon="filter_alt"
              rightIcon="expand_more" text="Filter By" [matMenuTriggerFor]="filterMenu"></app-button>
            <mat-menu #filterMenu="matMenu" backdropClass="qtd__menu">
              <label (click)="filterByEMP = 'All';selectedPosEMP = '';selectedOrgEMP = '';filterEMP();"
                mat-menu-item>All</label>
              <label (click)="filterByEMP = 'Positions';selectedOrgEMP = '';filterPanelEMP = true;"
                mat-menu-item>{{("Position" | labelReplacement)| async}}</label>
              <label (click)="filterByEMP = 'Organisations';selectedPosEMP = '';filterPanelOrg = true;"
                mat-menu-item>Organisation</label>
            </mat-menu>
          </div>
        </div>
        <!-- EMP Data -->
        <div class="flex flex-col w-full">
          <div class="flex flex-row" style="align-items:baseline;" *ngIf="employees.length > 0">
            <mat-checkbox (change)="selectAllEmp($event)"
              [indeterminate]="empSelection.selected.length > 0 && empSelection.selected.length < employees.length"
              [checked]="employees.length > 0 && empSelection.selected.length === employees.length"
              class="mr-2"></mat-checkbox>
            <label>All {{("Employee" | labelReplacement)| async}}s</label>
          </div>

          <div class="flex flex-row mt-2 mb-2" style="align-items:flex-end;" *ngFor="let emp of employees">
            <mat-checkbox [checked]="empSelection.selected.includes(emp.id)" class="mr-2"
              (change)="selectEMP($event,emp)"></mat-checkbox>
            <img class="rounded-full mr-2 mt-1" style="width:2rem;height:2rem"
              [src]="emp?.person?.image" onerror="this.src='assets/img/ImageNotFound.jpg'">
            <div class="flex flex-col">
              <span class="font-bold">{{(emp?.person?.firstName ?? '') + " " + (emp?.person?.lastName ?? '')}}</span>
              <span class="text-gray-400">{{emp?.person?.username ?? ''}}</span>
            </div>
          </div>
        </div>
        <div class="flex mt-3" style="justify-content:flex-end;">
          <app-button [disabled]="empSelection.selected.length < 1" style="width:30%;" text="Continue" size="sm"
            color="secondary" ButtonType="button" (clicked)="stepper.next()"></app-button>
        </div>
      </div>
    </mat-step>
    <mat-step
      [completed]="(releaseSelection.selected[0] === 2 ? evalSelection.selected.length >= this.reqSignOffs:releaseSelection.selected.length > 0)"
      label="Evaluator Settings">
      <div class="flex flex-col">
        <div class="flex flex-row justify-between mb-3 mt-4">
          <div class="flex" style="width:50%;">
            <span class="text-gray-500 text-xs font-light">Select Evaluator(s) to complete the selected {{("Task" | labelReplacement)| async}} & Skill
              Qualificaitions</span>
          </div>
          <div>
            <app-button ButtonType="button" text="Release {{('Task' | labelReplacement)| async}} & Skill Qualification" size="sm" [disabled]="true"></app-button>
          </div>
        </div>

        <div class="flex flex-col bg-white customBorder rounded-sm">
          <mat-form-field appearance="outline" class="search-input-field">
            <mat-icon matPrefix>search</mat-icon>
              <input (input)="evalInputChange($event)" [value]="searchText" type="text" matInput
              placeholder="Enter keywords to search">
          </mat-form-field>
          <table cdkDropList [dataSource]="dataSourceEval" (cdkDropListDropped)="reorderEvaluator($event)"
            class="w-full" mat-table>
            <ng-container matColumnDef="cb">
              <th style="width:5%;" mat-header-cell *matHeaderCellDef>
                <mat-checkbox
                  [checked]="dataSourceEval.data.length > 0 && evalSelection.selected.length === dataSourceEval.data.length"
                  [indeterminate]="evalSelection.selected.length > 0 && evalSelection.selected.length < dataSourceEval.data.length"
                  (change)="selectAllEvaluators($event)"></mat-checkbox>
              </th>
              <td mat-cell *matCellDef="let row">
                <mat-checkbox [checked]="evalSelection.selected.includes(row.evaluatorId)"
                  (change)="$event.checked ? evalSelection.select(row.evaluatorId):evalSelection.deselect(row.evaluatorId);"
                  style="margin-top:0.3rem;"></mat-checkbox>
              </td>
            </ng-container>
            <ng-container matColumnDef="order">
              <th style="width:5%;" mat-header-cell *matHeaderCellDef>

              </th>
              <td mat-cell *matCellDef="let row">
                <app-icon cdkDragHandle icon="drag_indicator" class="text-gray-400" style="cursor:move;"></app-icon>
              </td>
            </ng-container>
            <ng-container matColumnDef="eval">
              <th style="width:60%;" mat-header-cell *matHeaderCellDef>
                Evaluators
              </th>
              <td mat-cell *matCellDef="let row">
                <span>{{row.evaluatorName}}</span>
              </td>
            </ng-container>
            <ng-container matColumnDef="pos">
              <th mat-header-cell *matHeaderCellDef>
                {{("Position" | labelReplacement)| async}}
              </th>
              <td mat-cell *matCellDef="let row">
                <span>{{row.positionTitle === '' ?
                  'N/A':row.positionTitle.substring(0,row.positionTitle.length-2)}}</span>
              </td>
            </ng-container>

            <tr style="border-top-width: 2px;" mat-header-row class="pl-2 pr-2" *matHeaderRowDef="displayedColumns">
            </tr>
            <tr cdkDrag mat-row class="pr-2 pl-2" *matRowDef="let row; columns: displayedColumns"></tr>
            <!-- Row shown when there is no matching data.-->
            <tr class="mat-row" *matNoDataRow>
              <td class="mat-cell text-center" [attr.colspan]="displayedColumns.length">No Evaluators Found
              </td>
            </tr>
          </table>
          <app-input-error text="Please Select At least 1 Evaluator"
            *ngIf="evalSelection.selected.length < 1"></app-input-error>
        </div>

        <div class="flex flex-col">
          <span class="font-bold text-lg mt-5 mb-4">{{("Task" | labelReplacement)| async}} & Skill Qualification Release Settings:</span>
          <!-- <span class="text-gray-400 font-xs font-light mb-3">Select the settings for when to release TQs to Evaluator
            dashboards</span> -->
          <div class="flex flex-row" style="align-items:baseline;">
            <mat-checkbox [checked]="releaseSelection.selected[0] === 1"
              (change)="$event.checked ? (changeReleaseSelection()):releaseSelection.deselect(1)"
              class="mr-3"></mat-checkbox>
            <label class="mr-1">Release to all assigned Evaluators - One Sign Off is Required.</label>
            <app-icon
              matTooltip="'{{('Task' | labelReplacement)| async}}s & Skills will be released to all assigned Evaluators on the {{('Task' | labelReplacement)| async}} & Skill Qualification Release Date. Upon successful submission of one {{('Task' | labelReplacement)| async}} & Skill Qualification for the listed {{('Task' | labelReplacement)| async}}(s) & Skill(s), the pending {{('Task' | labelReplacement)| async}} & Skill Qualifications will be removed from all other assigned Evaluator\'s dashboards'"
              icon="help_outline" class="text-gray-400"></app-icon>
          </div>
          <div class="flex flex-row mt-3" style="align-items:baseline;">
            <mat-checkbox [checked]="releaseSelection.selected[0] === 2"
              (change)="$event.checked ? releaseSelection.select(2):releaseSelection.deselect(2)"
              class="mr-3"></mat-checkbox>
            <label class="mr-1">Multiple Sign-offs required </label>
            <!-- <app-icon class="text-gray-400" icon="help_outline"
              [matTooltip]="'The Tasks will release to the first Evaluator on the Release Date and to subsequent evaluators when the previous Evaluator has submitted qualification results'"></app-icon> -->
          </div>
          <div style="width:15%;margin-left:2.5rem;">
            <mat-select [(ngModel)]="reqSignOffs" [disabled]="releaseSelection.selected[0] !== 2"
              class="appearance-none rounded border px-4 py-2.5 mt-2">
              <mat-option [value]="1">1</mat-option>
              <mat-option [value]="2">2</mat-option>
              <mat-option [value]="3">3</mat-option>
              <mat-option [value]="4">4</mat-option>
              <mat-option [value]="5">5</mat-option>
            </mat-select>
          </div>
          <app-input-error *ngIf="releaseSelection.selected.length < 1"
            text="Please Select Required Release Setting Option"></app-input-error>
          <div class="flex flex-col mt-3" style="margin-left:2.5rem">
            <app-label class="mb-2 text-gray-400"
              text="Select the settings for when to release TQs & SQs to Evaluator dashboards:"></app-label>
            <div class="flex flex-row" style="align-items: baseline;">
              <mat-checkbox [disabled]="releaseSelection.selected[0] !== 2"
                [checked]="whenToReleaseSelection.selected[0] === 1"
                (change)="$event.checked ? whenToReleaseSelection.select(1):whenToReleaseSelection.deselect(1);"
                class="mr-3"></mat-checkbox>
              <label>Release listed {{("Task" | labelReplacement)| async}}s & Skill to all Evaluator's EMP dashboards on the {{("Task" | labelReplacement)| async}} & Skill Qualification Release Date -
                order of Evaluator completion does not matter.
                <app-icon class="text-gray-400"
                  [matTooltip]="'When required sign-offs are reached for each Task & Skill, the pending qualifications will be removed from all other Evaluator\'s dashboards'"
                  icon="help_outline"></app-icon></label>
            </div>
            <div>
              <mat-checkbox [disabled]="releaseSelection.selected[0] !== 2"
                [checked]="whenToReleaseSelection.selected[0] === 2"
                (change)="$event.checked ? whenToReleaseSelection.select(2):whenToReleaseSelection.deselect(2);"
                class="mr-3"></mat-checkbox>
              <label>Release listed {{("Task" | labelReplacement)| async}}s to all Evaluator's EMP dashboards in the order specified above.
                <app-icon class="text-gray-400"
                  matTooltip="'The {{('Task' | labelReplacement)| async}}s & Skills will release to the first Evaluator on the Release Date and to subsequent evaluators when the previous Evaluator has submitted qualification results'"
                  icon="help_outline"></app-icon>
              </label>
            </div>
            <app-input-error text="Please Select A Release Option"
              *ngIf="releaseSelection.selected[0] === 2 && whenToReleaseSelection.selected.length < 1"></app-input-error>
          </div>
        </div>
        <div class="flex mt-4" style="justify-content:flex-end;">
          <app-button class="mb-3"
            [disabled]="(releaseSelection.selected[0] === 2 ? (whenToReleaseSelection.selected.length < 1):releaseSelection.selected.length < 1) || evalSelection.selected.length < 1"
            style="width:30%;" text="Continue" size="sm" color="secondary" ButtonType="button"
            (clicked)="checkEvaluators();"></app-button>
        </div>
      </div>
    </mat-step>
    <mat-step [completed]="hasAnySelection" label="Select {{('Task' | labelReplacement)| async}}s & Skills">
      <mat-tab-group (selectedTabChange)="onTabChange($event)">
        <mat-tab label="Tasks">
          <div class="flex flex-col w-full">
            <div class="flex flex-row items-center mt-3 justify-between">
              <div class="flex border-b-0.8 border-gray-one pr-4" style="width: 65%;">
                <app-icon icon="search"></app-icon>
                <input (input)="filter()" class="text-sm flex-grow focus:outline-none" placeholder="Search" type="text"
                  [(ngModel)]="filterTaskString">
              </div>
              <div class="flex flex-row mb-3 ml-2">
                <app-button [customClasses]="'pl-2 pr-2'" type="button" color="secondary" size="sm" leftIcon="filter_alt"
                  rightIcon="expand_more" [text]="'Filter By ' + filterTaskBy"
                  [matMenuTriggerFor]="filterMenuTask"></app-button>
                <mat-menu #filterMenuTask="matMenu" backdropClass="qtd__menu">
                  <label (click)="filterTaskBy = 'Positions';filterPanelTask = true;" mat-menu-item>{{("Position" | labelReplacement)| async}}</label>
                  <label (click)="filterTaskBy = 'All';selectedPosTask = '';filter();" mat-menu-item>All</label>
                </mat-menu>
              </div>

            </div>
            <div>
              <!-- Treeview here -->
              <app-spinner *ngIf="dataSource.data === undefined"></app-spinner>
              <span *ngIf="dataSource.data !== undefined && dataSource.data.length < 1">No {{("Task" | labelReplacement)| async}}s Found</span>
              <ng-container *ngIf="dataSource.data !== undefined && dataSource.data.length > 0">
                <div class="flex flex-col">
                  <mat-tree *ngIf="dataSource && dataSource.data.length > 0" [dataSource]="dataSource"
                    [treeControl]="treeControl" class="qtd-tree">
                    <!-- This is the tree node template for leaf nodes -->
                    <!-- There is inline padding applied to this node using styles.
                    This padding value depends on the mat-icon-button width. -->
                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
                      <ng-container *ngIf="node.checkbox && node.isTask">
                        <mat-checkbox [checked]="node.selected" (change)="onTaskChange($event,node);">
                          {{node.description}}</mat-checkbox>
                      </ng-container>
                      <ng-container *ngIf="node.checkbox && !node.isTask">
                        <span style="margin-left: 1.7rem;">{{node.description}}</span>
                      </ng-container>
                      <ng-container *ngIf="!node.checkbox">
                        <app-icon style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;<span
                          style="color: rgb(92, 155, 49);">{{node.description}}</span>
                      </ng-container>
                      <!-- <ng-container *ngIf="!node.checkbox && filtered(node) && node.HasChild">
                          <span>{{node.description}}</span>
                        </ng-container> -->
                    </mat-tree-node>

                    <!-- This is the tree node template for expandable nodes -->
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                      <div class="mat-tree-node">
                        <!-- <button mat-icon-button> -->
                        <app-icon class="cursor-pointer"
                          [icon]="treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'" matTreeNodeToggle
                          [attr.aria-label]="'Toggle ' + node.description">
                        </app-icon>
                        <!-- </button> -->
                        <mat-checkbox [checked]="node.selected" [indeterminate]="node.indeterminate && !node.selected"
                          (change)="itemToggle($event.checked,node)"></mat-checkbox>
                        <span>{{node.description}}</span>
                      </div>

                      <div [class.qtd-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                        <ng-container matTreeNodeOutlet></ng-container>
                      </div>
                    </mat-nested-tree-node>
                  </mat-tree>
                  <span *ngIf="dataSource && dataSource.data.length < 1">No {{("Task" | labelReplacement)| async}} Found</span>
                </div>
              </ng-container>
            </div>
          </div>
        </mat-tab>
        <mat-tab label="Skills">
          <app-data-loader *ngIf="showLoader"></app-data-loader>
          <div *ngIf="!showLoader" class="flex flex-col w-full">
            <div class="flex flex-row items-center mt-3 justify-between">
              <div class="flex border-b-0.8 border-gray-one pr-4" style="width: 65%;">
                <app-icon icon="search"></app-icon>
                <input (input)="filter()" class="text-sm flex-grow focus:outline-none" placeholder="Search" type="text"
                  [(ngModel)]="filterTaskString">
              </div>
              <div class="flex flex-row mb-3 ml-2">
                <app-button [customClasses]="'pl-2 pr-2'" type="button" color="secondary" size="sm" leftIcon="filter_alt"
                  rightIcon="expand_more" [text]="'Filter By ' + filterBy"
                  [matMenuTriggerFor]="filterMenuTask"></app-button>
                  <mat-menu #filterMenuTask="matMenu" backdropClass="qtd__menu">
                    <label (click)="filterBy = 'Positions';filterPanelSkill = true;" mat-menu-item>{{("Position" | labelReplacement)| async}}</label>
                    <label (click)="filterBy = 'All';selectedPos=null;readyEnablingObjectiveTreeData();" mat-menu-item>All</label>
                  </mat-menu>
              </div>
            </div>
              <app-spinner *ngIf="enablingObjectiveDataSource.data === undefined"></app-spinner>
              <span *ngIf="enablingObjectiveDataSource.data !== undefined && enablingObjectiveDataSource.data.length < 1">No Skills Found</span>
              <ng-container *ngIf="enablingObjectiveDataSource.data.length > 0">
                <div class="flex flex-col">
                  <mat-tree [dataSource]="enablingObjectiveDataSource" [treeControl]="EOTreeControl" class="qtd-tree">
                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
                      <mat-checkbox [checked]="node.selected" (change)="onEOChange($event,node)" *ngIf="node.checkbox !== undefined && node.checkbox">
                        {{node.description}}
                      </mat-checkbox>
                      <ng-container *ngIf="node.checkbox !== undefined && !node.checkbox">
                        <div class="flex">
                          <app-icon class="mr-2" style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;
                          <span style="color: rgb(92, 155, 49);">{{node.description}}
                          </span>
                        </div>
                      </ng-container>
                      <span *ngIf="node.checkbox === undefined">{{node.description}}</span>
                    </mat-tree-node>
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                      <div class="mat-tree-node">
                        <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.description">
                          <app-icon [icon]="EOTreeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'">
                          </app-icon>
                        </button>
                        <mat-checkbox [checked]="node.selected" [indeterminate]="node.indeterminate && !node.selected"
                        (change)="itemToggleEO($event.checked,node)"></mat-checkbox>
                        <span class="ml-1 pb-1">{{node.description}}</span>
                      </div>
                      <div [class.qtd-tree-invisible]="!EOTreeControl.isExpanded(node)" role="group">
                        <ng-container matTreeNodeOutlet></ng-container>
                      </div>
                    </mat-nested-tree-node>
                  </mat-tree>
                </div>
              </ng-container>
          </div>
        </mat-tab>
      </mat-tab-group>
      <div class="flex mt-3" style="justify-content:flex-end;">
        <app-button [disabled]="!hasAnySelection" style="width:30%;" text="Continue" size="sm" color="secondary"
          ButtonType="button" (clicked)="stepper.next();"></app-button>
        <app-input-error *ngIf="!hasAnySelection">Please Select At least 1 {{("Task" | labelReplacement)| async}} or Skill</app-input-error>
      </div>
    </mat-step>
    <mat-step label="Review & Release">
      <div class="flex flex-col">
        <span class="mt-5 mb-3 font-light text-sm text-gray-400">Review and confirm the selected {{("Task" | labelReplacement)| async}}s & Skills, {{("Employee" | labelReplacement)| async}}s, and
          Evaluators prior to releasing to EMP: </span>
        <table [dataSource]="dataSourceReview" class="w-full customBorder rounded-sm" mat-table>
          <ng-container matColumnDef="emp">
            <th style="width:10%;" mat-header-cell *matHeaderCellDef>
              {{("Employee" | labelReplacement)| async}} Name
            </th>
            <td mat-cell *matCellDef="let row">
              {{row.empName}}
            </td>
          </ng-container>
          <ng-container matColumnDef="task">
            <th style="width:25%;" mat-header-cell *matHeaderCellDef>
              {{("Task" | labelReplacement)| async}}
            </th>
            <td mat-cell *matCellDef="let row">
              <span>{{row.taskDescription}}</span>
            </td>
          </ng-container>
          <ng-container matColumnDef="skill">
            <th style="width:25%;" mat-header-cell *matHeaderCellDef>
              Skill
            </th>
            <td mat-cell *matCellDef="let row">
              <span>{{row.enablingObjectiveDescription}}</span>
            </td>
          </ng-container>
          <ng-container matColumnDef="eval">
            <th style="width:10%;" mat-header-cell *matHeaderCellDef>
              Evaluators
            </th>
            <td mat-cell *matCellDef="let row">
              <span>{{row.evaluatorName}}</span>
            </td>
          </ng-container>

          <tr style="border-top-width: 2px;" mat-header-row class="pl-2 pr-2" *matHeaderRowDef="displayedColumnsReview">
          </tr>
          <tr style="vertical-align: top;" mat-row class="pr-2 pl-2"
            *matRowDef="let row; columns: displayedColumnsReview"></tr>
          <!-- Row shown when there is no matching data.-->
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell text-center" [attr.colspan]="displayedColumnsReview.length">No {{("Task" | labelReplacement)| async}} & Skill Qualifications Found
            </td>
          </tr>
        </table>

        <!-- Task Qualification Settings -->
        <div class="flex flex-col">
          <span class="font-bold text-lg mt-5 mb-4">{{("Task" | labelReplacement)| async}} & Skill Qualification Release Settings:</span>
          <!-- <span class="text-gray-400 font-xs font-light mb-3">Select the settings for when to release TQs to Evaluator
            dashboards</span> -->
          <div class="flex flex-row" style="align-items:baseline;">
            <mat-checkbox [disabled]="true" [checked]="releaseSelection.selected[0] === 1"
              (change)="$event.checked ? releaseSelection.select(1):releaseSelection.deselect(1)"
              class="mr-3"></mat-checkbox>
            <label class="mr-1">Release to all assigned Evaluators - One Sign Off is Required.</label>
            <app-icon
              matTooltip="'{{('Task' | labelReplacement)| async}}s & Skills will be released to all assigned Evaluators on the {{('Task' | labelReplacement)| async}} & Skill Qualification Release Date. Upon successful submission of one {{('Task' | labelReplacement)| async}} & Skill Qualification for the listed {{('Task' | labelReplacement)| async}}(s) & Skill(s), the pending {{('Task' | labelReplacement)| async}} & Skill Qualifications will be removed from all other assigned Evaluator\'s dashboards'"
              icon="help_outline" class="text-gray-400"></app-icon>
          </div>
          <div class="flex flex-row mt-3" style="align-items:baseline;">
            <mat-checkbox [disabled]="true" [checked]="releaseSelection.selected[0] === 2"
              (change)="$event.checked ? releaseSelection.select(2):releaseSelection.deselect(2)"
              class="mr-3"></mat-checkbox>
            <label class="mr-1">Multiple Sign-offs required </label>
            <!-- <app-icon class="text-gray-400" icon="help_outline"
              [matTooltip]="'The Tasks will release to the first Evaluator on the Release Date and to subsequent evaluators when the previous Evaluator has submitted qualification results'"></app-icon> -->
          </div>
          <div style="width:15%;margin-left:2.5rem;">
            <mat-select [disabled]="true" [value]="reqSignOffs" class="appearance-none rounded border px-4 py-2.5 mt-2">
              <mat-option [value]="1">1</mat-option>
              <mat-option [value]="2">2</mat-option>
              <mat-option [value]="3">3</mat-option>
              <mat-option [value]="4">4</mat-option>
              <mat-option [value]="5">5</mat-option>
            </mat-select>
          </div>
          <div class="flex flex-col mt-3" style="margin-left:2.5rem">
            <app-label class="mb-2 text-gray-400"
              text="Select the settings for when to release TQs & SQs to Evaluator dashboards:"></app-label>
            <div class="flex flex-row" style="align-items: baseline;">
              <mat-checkbox [disabled]="true" [checked]="whenToReleaseSelection.selected[0] === 1"
                (change)="$event.checked ? whenToReleaseSelection.select(1):whenToReleaseSelection.deselect(1);"
                class="mr-3"></mat-checkbox>
              <label>Release listed {{("Task" | labelReplacement)| async}}s & Skills to all Evaluator's EMP dashboards on the {{("Task" | labelReplacement)| async}} & Skill Qualification Release Date -
                order of Evaluator completion does not matter.
                <app-icon class="text-gray-400"
                  matTooltip="'When required sign-offs are reached for each {{('Task' | labelReplacement)| async}} & Skill, the pending qualifications will be removed from all other Evaluator\'s dashboards'"
                  icon="help_outline"></app-icon></label>
            </div>
            <div>
              <mat-checkbox [disabled]="true" [checked]="whenToReleaseSelection.selected[0] === 2"
                (change)="$event.checked ? whenToReleaseSelection.select(2):whenToReleaseSelection.deselect(2);"
                class="mr-3"></mat-checkbox>
              <label>Release listed {{("Task" | labelReplacement)| async}}s & Skills to all Evaluator's EMP dashboards in the order specified above.
                <app-icon class="text-gray-400"
                  matTooltip="'The {{('Task' | labelReplacement)| async}}s & Skills will release to the first Evaluator on the Release Date and to subsequent evaluators when the previous Evaluator has submitted qualification results'"
                  icon="help_outline"></app-icon>
              </label>
            </div>
          </div>
        </div>
        <form class="flex flex-col w-full mt-3" [formGroup]="reviewForm">
          <mat-checkbox formControlName="specific" class="mb-3">Show {{("Task" | labelReplacement)| async}} & Skill Specific Suggestions upon launch of {{("Task" | labelReplacement)| async}} & Skill
            Qualification</mat-checkbox>
          <mat-checkbox formControlName="questions">Show {{("Task" | labelReplacement)| async}} & Skill Questions</mat-checkbox>
          <!-- Dates -->
          <div class="flex flex-row justify-between w-full mt-4">
            <div class="flex flex-row gap-4 mb-6" style="width: 50%;">
              <div class="pr-2" style="width:50%">
                <app-label text="Release Date"></app-label>
                <app-date formControlName="release"></app-date>
                <app-input-error *ngIf="reviewForm.get('release')?.hasError('required')"
                  text="Please Enter Release Date"></app-input-error>
              </div>
              <div class="flex flex-col pr-4 time-input" style="width: 50%;">
                <app-label [for]="'startTime'" [text]="'Start Time'" class="text-gray-400"  [ngClass]="{'label required': reviewForm.get('startTime')?.hasError('required')}">
                </app-label>
                <div class="flex flex-col pr-4 time-input">
                 <mat-form-field appearance="outline" class="w-full">
                  <input matInput type="time"  formControlName="startTime" />
                 </mat-form-field>
                </div>
              </div>
            </div>
            <div style="width:45%">
              <app-label text="Due Date"></app-label>
              <app-date formControlName="due"></app-date>
              <app-input-error text="Please Enter Due Date"
                *ngIf="reviewForm.get('due')?.hasError('required')"></app-input-error>
            </div>
          </div>
        </form>
 
        <div class="flex mt-4" style="justify-content:flex-end;">
          <app-button [disabled]="reviewForm.invalid || saveSpinner" [spinner]="saveSpinner" style="width:30%;"
            text="Save" size="sm" color="secondary" ButtonType="button" (clicked)="releaseTQ()"></app-button>
        </div>
      </div>
    </mat-step>
  </mat-stepper>
</div>


<ng-container *ngIf="filterPanelTask">
  <app-flypanel-filter-tq-emp-by [selectedPos]="selectedPosTask"
    (filterSelected)="selectedPosTask = $event.data;filterPanelTask = false;filter();"
    (closed)="filterPanelTask=false;"></app-flypanel-filter-tq-emp-by>
</ng-container>

<ng-container *ngIf="filterPanelSkill">
  <app-flypanel-filter-tq-emp-by [selectedPos]="selectedPos"
    (filterSelected)="selectedPos = $event.data;filterPanelSkill = false;readyEnablingObjectiveTreeData();"
    (closed)="filterPanelSkill=false;"></app-flypanel-filter-tq-emp-by>
</ng-container>

<ng-container *ngIf="filterPanelEMP">
  <app-flypanel-filter-tq-emp-by [selectedPos]="selectedPosEMP"
    (filterSelected)="selectedPosEMP = $event.data;filterPanelEMP = false;selectedOrgEMP = '';filterEMP();"
    (closed)="filterPanelEMP=false;"></app-flypanel-filter-tq-emp-by>
</ng-container>

<ng-container *ngIf="filterPanelOrg">
  <app-flypanel-filter-emp-by-org [selectedOrg]="selectedOrgEMP" (closed)="filterPanelOrg = false;"
    (orgSelected)="selectedOrgEMP = $event;filterPanelOrg=false;selectedPosEMP='';filterEMP();">

  </app-flypanel-filter-emp-by-org>
</ng-container>
