<app-data-loader *ngIf="mainSpinner"></app-data-loader>
<div class="flex-col w-full" *ngIf="!mainSpinner">
  <div class="flex flex-row justify-between items-center px-12 mt-5">
    <p class="text-xl font-semibold text-gray-900">Select Items from Question Bank</p>
    <app-button (click)="flyPanelSrvc.close()" ButtonType='icon' icon="close"></app-button>
  </div>
  <!-- header ends here -->

  <!--EO's start here-->
  <div class="flex flex-col ml-12 mr-12 mt-8">
    <div>
      <p class="font-semibold text-sm">Add {{("Enabling Objective" | labelReplacement)| async}} for Test Items</p>
    </div>

    <div>
      <button class="font-medium" (click)="ShowDropDown()" variant="text" style="color: rgb(92, 155, 49) !important;">List
        {{("Enabling Objective" | labelReplacement)| async}} for Selected {{("ILA" | labelReplacement)| async}}
        <app-icon *ngIf="isDropdownVisible" icon="expand_less"></app-icon>
        <app-icon *ngIf="!isDropdownVisible" icon="expand_more"></app-icon>
      </button>
      <div *ngIf="isDropdownVisible">
        <table class="table w-full border text-left mt-5 hover">
          <tbody>
            <tr *ngFor="let item of obj_topics" class="table-row text-sm font-normal hover:bg-gray-50">
              <td class="table-cell align-middle border-b-0.8 border-gray-one">
                <input type="checkbox" [(ngModel)]="item.checked" [value]="item.id"
                  (change)="checkEnablingObjectives(item.id)" />
              </td>
              <td class=" table-cell align-middle border-b-0.8 border-gray-one">
                {{ item.number + " - " + item.description}}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>

  <!--EO's start end-->

  <!--2 buttons start-->
  <div class="mt-12 ml-12 mr-12">
    <p class="font-semibold text-sm" *ngIf="generate_random && select_check">Choose one of the following to add
      questions</p>

    <!--2 cols starts-->
    <div class="flex flex-col">
      <!--Select Questions Start-->
      <div *ngIf="this.select_check">
        <button class="underline font-medium" (click)="ShowDropDownSelect()" variant="text"
          style="color: rgb(92, 155, 49) !important;">
          <app-icon *ngIf="!generate_random" icon="chevron_left"></app-icon>Select Questions
        </button>

        <div *ngIf="isSelectDropdownVisible">
          <!--Question Type Div Starts-->
          <div>
            <div class="flex flex-row justify-between">
              <div class="mt-4">
                <p class="font-medium">Question Type</p>
              </div>
              <div class="mt-3">
                <app-button (clicked)="OnClick()" color="secondary" text="Apply Settings" size="sm">
                </app-button>
              </div>
            </div>

            <div class="w-78 flex flex-row ">
              <div class="flex flex-row-wrap justify-between">
                <mat-checkbox class="mr-4" *ngFor="let i of question_type" [(ngModel)]="i.checked" [value]="i.id">
                  {{i.description}}</mat-checkbox>
              </div>
            </div>
          </div>
          <!--Question Type Div Ends-->

          <!--Taxonomy Level Div Starts-->
          <div>
            <div class="mt-4">
              <p class="font-medium">Taxonomy Level <app-icon class="mr-2" matTooltipClass="multiline-tooltip"
                  matTooltip="Select the appropriate level of complexity for the test question &#13; Recall - Remember facts and concept &#13; Application - Use information and concepts in different situations &#13; Analyze - Establish relationships between presented information"
                  icon="help"></app-icon>
              </p>
            </div>


            <div class="w-78 flex flex-row ">
              <div class="flex flex-row-wrap justify-between">
                <mat-checkbox class="mr-12" *ngFor="let i of taxonomy" [(ngModel)]="i.checked" [value]="i.id">{{i.description}}
                </mat-checkbox>
              </div>
            </div>
          </div>
          <!--Taxonomy Level Div Ends-->

        </div>

        <!--div for table start-->
        <div *ngIf="dataTransfered">
          <table class="table w-full border border-gray-one text-left mt-5 hover">
            <thead>
              <tr class="table-row text-xs text-gray-four">
                <th class="table-cell border-gray-one font-normal"> <mat-checkbox (change)="checkAll($event)" [checked]="ans_1.length === ans.length && ans_1.length !== 0" [indeterminate]="ans_1.length < ans.length && ans_1.length !== 0"></mat-checkbox></th>
                <th class="table-cell border-gray-one font-normal">Test Question</th>
                <th class="table-cell border-gray-one font-normal">Type</th>
                <th class="table-cell border-gray-one font-normal">Taxonomy Level</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of ans" class="h-11 table-row text-sm font-normal hover:bg-gray-50">
                <td class=" table-cell align-middle border-b-0.8 border-gray-one">
                  <mat-checkbox [checked]="ans_1.includes(item)"
                    (change)="OnSelectionChange(item,$event)"></mat-checkbox>
                </td>
                <td [matTooltip]="item.ans"
                  class="max-w-125 overflow-hidden table-cell align-middle border-b-0.8 border-gray-one">
                  <div [innerHTML]="item.ans"></div>
                </td>
                <td class=" table-cell align-middle border-b-0.8 border-gray-one">
                  {{item.type}}
                </td>
                <td class=" table-cell align-middle border-b-0.8 border-gray-one">
                  {{item.tax}}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!--div for table end-->
      </div>
      <!--Select Questions End-->

      <div class="mt-6 mb-2" *ngIf="generate_random && select_check">
        <p class="text-gray-400">or</p>
      </div>


      <!--Generate Questions Randomly Start-->
      <div *ngIf="generate_random">
        <button class="underline font-medium" (click)="ShowDropDownRandomly()" variant="text"
          style="color: rgb(92, 155, 49) !important;">
          <app-icon *ngIf="!this.select_check" icon="chevron_left"></app-icon>Generate Questions Randomly
        </button>

        <div *ngIf="RandomlyisDropdownVisible">
          <!--number of questions to add starts-->
          <div class="mt-4">
            <p class="font-medium">No. of questions to add</p>
            <div class="border w-20 h-10 rounded">
              <p class="float-left text-base mt-2 align-center ml-2">{{ generate_number}}</p>
              <div class="float-right flex flex-col mt-0">
                <button (click)="IncreaseNumber()" class=" focus:outline-none">
                  <app-icon icon=" expand_less"></app-icon>
                </button>
                <button (click)="DecreaseNumber()" class="mt--2 focus:outline-none">
                  <app-icon icon="expand_more"></app-icon>
                </button>
              </div>
            </div>
          </div><br>
          <!--number of questions to add ends-->

          <!--Question Type Div Starts-->
          <div>
            <div class="flex flex-row justify-between">
              <div class="mt-4">
                <p class="font-medium">Question Type</p>
              </div>
            </div>

            <div class="w-78 flex flex-row ">
              <div class="flex flex-row-wrap justify-between">
                <mat-checkbox class="mr-4" *ngFor="let i of question_type" [(ngModel)]="i.checked" [value]="i.id">
                  {{i.description}}</mat-checkbox>
              </div>
            </div>
          </div>
          <!--Question Type Div Ends-->

          <!--Taxonomy Level Div Starts-->
          <div>
            <div class="mt-4">
              <p class="font-medium">Taxonomy Level <app-icon class="mr-2" matTooltipClass="multiline-tooltip"
                  matTooltip="Select the appropriate level of complexity for the test question &#13; Recall - Remember facts and concept &#13; Application - Use information and concepts in different situations &#13; Analyze - Establish relationships between presented information"
                  icon="help"></app-icon>
              </p>
            </div>


            <div class="w-78 flex flex-row ">
              <div class="flex flex-row-wrap justify-between">
                <mat-checkbox class="mr-12" *ngFor="let i of taxonomy" [(ngModel)]="i.checked" [value]="i.id">{{i.description}}
                </mat-checkbox>
              </div>
            </div>
          </div>
          <!--Taxonomy Level Div Ends-->

          <div class="flex- flex-row w-3/12 mt-3">
            <app-button (clicked)="ImportTest()" text="Import to Test" color="secondary" size="sm"></app-button>
          </div>
        </div>
      </div>
      <!--Generate Questions Randomly End-->

    </div>
    <!--2 cols ends-->

  </div>
  <!--2 buttons end-->

  <!--Save Button starts-->
  <div class="ml-12 mr-12 float-right mt-8">
    <app-button (clicked)="OnSave()" size="sm" text="Save" color="secondary"></app-button>
  </div>
  <!--Save Button ends-->
</div>

