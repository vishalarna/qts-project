
<!-- <ng-container *ngIf="!addSaftyHazard">
 <div class="flex flex-row justify-between items-center px-12 mt-5">
  <p class="text-xl font-bold text-gray-900">Link Safety Hazards to ILA</p>
  <button type="button" (click)="flyPanelSrvc.close()">
    <app-icon icon="close"></app-icon>
  </button>
</div>

<div class="flex flex-col">
  <div class="mt-16 flex flex-row justify-between">
    <div class="w-4/12 ml-12 pt-2 text-gray-four">
      <p> Showing {{count_safetyhazards}} Safety Hazards(s)</p>
    </div>
    <div class="mr-5 flex flex-row ml-12 justify-between">
      <app-button color="secondary" type="button" size="sm" customClasses="w-57" (click)="LinkToILA()" text="Link Safety Hazards"></app-button>
    </div>
</div>
  <div class="ml-12">
    <app-button variant="text" size="sm" text="Add Safety Hazard" (click)="addSaftyHazard = true"></app-button>
  </div>

  <div class="flex-col pt-6 items-center pb-3 ml-4 mr-4">
    <mat-accordion [multi]="true">
      <mat-expansion-panel *ngFor="let item of sh_category" [expanded]="true">

        <mat-expansion-panel-header>
          <mat-panel-title class="justify-between">
            <p>{{ item.description }} ({{ item.count }})</p>
          </mat-panel-title>
        </mat-expansion-panel-header>


        <div *ngFor="let item2 of sh_category_topics">
          <mat-panel-title class="justify-between mt-2" *ngIf="item2.category_id === item.id">
            <div class="flex flex-nowrap">
              <mat-checkbox [checked]="item2.checked?item2.checked:false" [(ngModel)]="item2.checked"></mat-checkbox>

            <div class="flex flex-col">
              <p class="text-gray-900 ml-2">{{ item2.description }}</p>
         </div>
            </div>


          </mat-panel-title>
        </div>

      </mat-expansion-panel>
    </mat-accordion>

  </div>

</div>
</ng-container>-->

<ng-container   *ngIf="linkProcs">
  <div class="flex flex-col" [ngClass]="{ 'px-12 py-12':linkProcs}">
    <ng-container *ngIf="linkProcs">
      <div class="flex flex-row justify-between">
        <h2>Link {{("Safety Hazard" | labelReplacement)| async}}s to {{("ILA" | labelReplacement)| async}}</h2>
        <app-button ButtonType="icon" icon="close" (click)="flyPanelSrvc.close()" ></app-button>

      </div>
      <div class="flex flex-row items-center border-b-0.8 border-gray-one">
        <div class="flex flex-grow">
          <app-icon icon="search"></app-icon>
          <!-- (input)="filterData(dataSource.data,$event)" -->
          <input class="text-sm flex-grow focus:outline-none" placeholder="Search" type="text" (input)="filterData(dataSource.data,$event)"
             [(ngModel)]="filterProcString">
        </div>
      </div>


      <!--Heading ends-->

      <div class="flex flex-row mt-3 items-center text-gray-four justify-between text-xs btn-group">

        <div class="cursor-pointer">
          <span> Showing:
            <label mat-button  class="mb-0">
              <p *ngIf="showActive" class="font-bold">
                Active
              </p>
            <!--   <p *ngIf="!showActive" class="font-bold">
                Inactive
              </p>
   -->
            </label>
        <!--     <app-icon icon="expand_more" [matMenuTriggerFor]="menu"></app-icon> -->
          </span>

         <!--  <mat-menu #menu="matMenu">
            <label mat-menu-item *ngIf="!showActive" (click)="toggleFilter(true)">
              Active</label>

            <label mat-menu-item *ngIf="showActive" (click)="toggleFilter(false)">
              Inactive</label>
          </mat-menu> -->
        </div>
        <app-button variant="text" icon="add" iconPosition="left" text="Add new {{('Safety Hazard' | labelReplacement)| async}}s"
          (clicked)="linkProcs=false;addProc=true"></app-button>

      </div>

      <div class="flex flex-col flex-wrap bg-gray-one mb-3 mt-3  px-3 py-3 rounded" *ngIf="linkedIds.length > 0">
        <div class="flex flex-row w-full justify-between mb-3">
          <p class="text-xs text-gray-four pt-2">{{linkedIds.length}} {{("Procedure" | labelReplacement)| async}}s selected</p>
          <app-button [disabled]="spinner" [spinner]="spinner" (clicked)="LinkToILA()" class="mb-2" type="button"
            color="secondary" size="sm" text="Link to {{('ILA' | labelReplacement)| async}}">
          </app-button>
        </div>
        <hr>
        <p class="text-xs text-gray-four mt-3">Selecting a Issuing Authority will select all {{("Procedure" | labelReplacement)| async}}s linked
          to
          the given Issuing Authority</p>
      </div>
      <!-- *ngIf="active_tasks" -->

      <app-spinner *ngIf="dataSource.data === undefined"></app-spinner>

      <ng-container *ngIf="dataSource.data !== undefined">
        <div *ngIf="dataSource.data.length < 1" class="flex flex-col">
          <span>No Data Found</span>
        </div>
        <div class="flex flex-col ">
          <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="qtd-tree">
            <!-- This is the tree node template for leaf nodes -->
            <!-- There is inline padding applied to this node using styles.
                    This padding value depends on the mat-icon-button width. -->
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
              <ng-container *ngIf="node.checkbox">
                <mat-checkbox (change)="onProcChange($event,node)" [checked]="node.selected">
                  {{node.description}}</mat-checkbox>
              </ng-container>
              <ng-container *ngIf="!node.checkbox">
                <app-icon style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;<span
                  style="color: rgb(92, 155, 49);">{{node.description}}</span>
              </ng-container>
            </mat-tree-node>

            <!-- This is the tree node template for expandable nodes -->
            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
              <div class="mat-tree-node">
                <button style="outline:none;" mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.description">
                  <app-icon [icon]="treeControl.isExpanded(node) ? 'expand_more' : 'expand_less'">
                  </app-icon>
                </button>

                <mat-checkbox [checked]="node.selected" [indeterminate]="node.indeterminate && !node.selected"
                  (change)="itemToggle($event.checked,node)">{{node.description}}</mat-checkbox>
              </div>

              <div [class.qtd-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                <ng-container matTreeNodeOutlet></ng-container>
              </div>
            </mat-nested-tree-node>
          </mat-tree>

        </div>
      </ng-container>
    </ng-container>
  </div>
</ng-container>



<app-flypanel-add-safety-hazards (closed)="recieveClosed()" *ngIf="addProc" (closed)="addProc=false;linkProcs=true">

</app-flypanel-add-safety-hazards>

