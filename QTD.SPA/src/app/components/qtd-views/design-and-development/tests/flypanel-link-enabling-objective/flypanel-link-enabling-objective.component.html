<!--Heading starts-->
<div class="flex flex-col px-12 py-12">
    <ng-container *ngIf="linkEOs">
        <div class="flex flex-row justify-between">
            <p class="font-bold text-lg m-0 p-0">Link {{("Enabling Objective" | labelReplacement)| async}} to Test</p>
            <app-button ButtonType="icon" icon="close" (clicked)="closed.emit('fp-sh-task-link-closed')"></app-button>

        </div>
        <div class="flex flex-row items-center border-b-0.8 border-gray-one mt-8">
            <div class="flex flex-grow">
                <app-icon icon="search"></app-icon>
                <input class="text-sm flex-grow focus:outline-none" placeholder="Search" type="text"
                    (input)="toggleFilter(showActive)" [(ngModel)]="filterEOString">
            </div>

        </div>

        <!--Heading ends-->

        <div class="flex flex-row mt-3 items-center text-gray-four justify-between text-xs btn-group">

            <div class="cursor-pointer">
                <span class="text-gray-400 "> Showing:
                    <label mat-button [matMenuTriggerFor]="menu" class="mb-0">
                        <p *ngIf="showActive" >
                            Active EOs
                        </p>
                        <p *ngIf="!showActive" >
                            Inactive EOs
                        </p>

                    </label>
                    <app-icon icon="expand_more" [matMenuTriggerFor]="menu"></app-icon>
                </span>

                <mat-menu #menu="matMenu">
                    <label mat-menu-item *ngIf="!showActive" (click)="toggleFilter(true)">
                        Active</label>

                    <label mat-menu-item *ngIf="showActive" (click)="toggleFilter(false)">
                        Inactive</label>
                </mat-menu>
            </div>

        </div>

        <div class="flex flex-col flex-wrap bg-gray-100 mt-3  px-3 py-3 rounded" *ngIf="linkedIds.length > 0">
            <div class="flex flex-row w-full justify-between">
                <p class="text-xs text-gray-four pt-2">{{linkedIds.length}} EOs selected</p>
                <app-button [spinner]="showLinkEOLoader" class="mb-2" type="button" color="secondary" size="sm"
                    text="View Linked Questions" (clicked)="ViewLinkedQuestions()">
                </app-button>
            </div>
        </div>

        <app-spinner *ngIf="isEOLoading"></app-spinner>
      <!-- <ng-container *ngIf="!isEOLoading">
        <div>No EO Found</div>
      </ng-container> -->

        <ng-container *ngIf="dataSourceWithTopic.data.length > 0">
            <div class="flex flex-col ">
              <!--   <mat-tree [dataSource]="dataSourceWithTopic" [treeControl]="treeControl" class="qtd-tree">

                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
                    <ng-container *ngIf="node.checkbox">
                        <mat-checkbox style="margin-left:0.2rem;" (change)="onEOChange($event,node)" [checked]="node.selected">
                        {{node.description}}</mat-checkbox>
                    </ng-container>
                    <ng-container *ngIf="!node.checkbox">
                        <app-icon style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;<span style="color: rgb(92, 155, 49);">{{node.description}}</span>
                    </ng-container>
                    </mat-tree-node>
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                        <div class="mat-tree-node">
                            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.description">
                                <app-icon [icon]="treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'">
                                </app-icon>
                            </button>

                            <mat-checkbox [checked]="node.selected"
                                [indeterminate]="node.indeterminate && !node.selected"
                                (change)="itemToggle($event.checked,node)">{{node.description}}</mat-checkbox>
                        </div>

                        <div [class.qtd-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                            <ng-container matTreeNodeOutlet></ng-container>
                        </div>
                    </mat-nested-tree-node>
                </mat-tree> -->

                <mat-tree [dataSource]="dataSourceWithTopic" [treeControl]="treeControl" class="qtd-tree">

                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
                      <ng-container *ngIf="node.checkbox">
                        <mat-checkbox style="margin-left:0.2rem;" (change)="onEOChange($event,node)" [checked]="node.selected">
                          {{node.description}} <span *ngIf="node.IsEO"
                            class="ml-1 qtd-meta-box p-1 font-bold">{{'EO'|uppercase}}</span></mat-checkbox>
                      </ng-container>
                      <ng-container *ngIf="node.checkbox !== undefined && !node.checkbox">
                        <app-icon style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;<span
                          style="color: rgb(92, 155, 49);">{{node.description}}</span>
                      </ng-container>
                      <ng-container *ngIf="node.checkbox === undefined">
                        <span style="color:black;margin-left:1.8rem">{{node.description}}</span>
                      </ng-container>
          
                    </mat-tree-node>
          
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                      <div class="mat-tree-node">
                        <!-- <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.description"> -->
                          <app-icon matTreeNodeToggle class="cursor-pointer" [icon]="treeControl.isExpanded(node) ? 'expand_more' : 'expand_less'">
                          </app-icon>
                        <!-- </button> -->
          
                        <mat-checkbox [checked]="node.selected" [indeterminate]="node.indeterminate && !node.selected"
                          (change)="itemToggle($event.checked,node)">{{node.description}}</mat-checkbox>
                      </div>
          
                      <div [class.qtd-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                        <ng-container matTreeNodeOutlet></ng-container>
                      </div>
                    </mat-nested-tree-node>
                  </mat-tree>

            </div>
        </ng-container>

        <!-- <ng-container *ngIf="dataSourceWithoutTopic.data.length > 0">
            <div class="flex flex-col ">
                <mat-tree [dataSource]="dataSourceWithoutTopic" [treeControl]="treeControl" class="qtd-tree">
                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>
                    <ng-container *ngIf="node.checkbox">
                        <mat-checkbox (change)="onEOChange($event,node)" [checked]="node.selected">
                        {{node.description}}</mat-checkbox>
                    </ng-container>
                    <ng-container *ngIf="!node.checkbox">
                        <app-icon style="color: rgb(92, 155, 49);" icon="link"></app-icon>&nbsp;<span style="color: rgb(92, 155, 49);">{{node.description}}</span>
                    </ng-container>
                    </mat-tree-node>
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                        <div class="mat-tree-node">
                            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.description">
                                <app-icon [icon]="treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'">
                                </app-icon>
                            </button>

                            <mat-checkbox [checked]="node.selected"
                                [indeterminate]="node.indeterminate && !node.selected"
                                (change)="itemToggle($event.checked,node)">{{node.description}}</mat-checkbox>
                        </div>

                        <div [class.qtd-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                            <ng-container matTreeNodeOutlet></ng-container>
                        </div>
                    </mat-nested-tree-node>
                </mat-tree>

            </div>
        </ng-container> -->
    </ng-container>

</div>
