<!-- header starts -->
<app-header [canGoBack]="true" prevUrl='/analysis/jta/task-detail' [queryParams]="{taskId:taskId}"
    title="{{'L.TaskLinkedToProcedure' | translate | dynamicLabelReplacement| async }}"></app-header>
<!-- header ends -->

<!-- main-header starts -->
<div class="flex flex-col px-12 py-8">
    <div class="flex flex-row text-sm text-gray-four">
        <p class="mb-12">Duty Areas / {{daNumber + ". " +
            this.taskDetail?.subdutyArea?.dutyArea?.description}} /
            {{daNumber
            + "." + sdaNumber + " " + taskDetail?.subdutyArea?.description }} / {{("Task" | labelReplacement)| async}} {{tNumber}} / {{("Procedure" | labelReplacement)| async}} Linkage
        </p>
    </div>
</div>
<!-- main-header ends -->

<!-- Procedures starts here -->
<div class="px-12">
    <!-- Content starts here -->
    <div class="flex flex-col pb-24">

        <!-- Header starts here -->
        <div class="flex flex-row mb-8 items-center">
            <div class="flex flex-col flex-grow space-y-2">
                <h1 class="flex-auto font-medium text-xl">{{("Procedure" | labelReplacement)| async}}s Linkage</h1>
            </div>
        </div>
        <!-- Steps Header ends here-->

        <!-- Table starts here -->
        <div class="flex flex-col">
            <!-- Table Content starts here -->
            <div class="shadow-md bg-white-one rounded">
                <!-- table header starts -->
                <div
                    class="flex flex-row items-center bg-white-one rounded-t-md py-6 px-6 space-x-2 border-b-0.8 border-gray-one float-right">
                    <app-textbox placeholder="Search here" (keyup)="filterTable($event)"></app-textbox>
                    <app-button icon="add" text="Add new" (clicked)="openFlyInPanel(procContainer)" size="sm"
                        color="secondary" *ngIf="procToUnLink.length==0"></app-button>
                    <app-button icon="remove" text=" Unlink from {{('Task' | labelReplacement)| async}}" (clicked)="UnLinkProcedureFromTask()" size="sm"
                        color="secondary" *ngIf="procToUnLink.length>0"></app-button>
                </div>
                <!-- table header ends -->

            </div> <!-- table cells starts -->
            <div class="shadow-md bg-white-one rounded-b-md mt-2">
                <mat-table [dataSource]="procDataSource" matSort #procSort="matSort">
                    <ng-container matColumnDef="id">
                        <mat-header-cell *matHeaderCellDef style="max-width: 100px;">
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row" style="max-width: 100px;"> <input type="checkbox"
                                (change)="RemoveFromLinkList(row.id)">
                        </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="number">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> #
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row"> {{row.number}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="description">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Description
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row"> {{row.description}} </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="usage">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Usage
                        </mat-header-cell>
                        <mat-cell *matCellDef="let row"> {{row.usage}} </mat-cell>
                    </ng-container>


                    <mat-header-row *matHeaderRowDef="displayColumns"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayColumns;"></mat-row>

                    <!-- Row shown when there is no matching data.-->
                    <tr class="mat-row flex text-center " *matNoDataRow>
                        <td class="mat-cell w-full m-2">No data to display</td>
                    </tr>

                </mat-table>
                <app-data-loader *ngIf="!procDataSource"></app-data-loader>
                <mat-paginator [pageSizeOptions]="[20, 40, 60]" showFirstLastButtons #procPaging
                    aria-label="Select page of periodic elements">
                </mat-paginator>
            </div>
            <!-- table cells ends -->
            <!-- Table Content ends here -->
        </div>
        <!-- Table ends here -->

    </div>
    <!-- Content ends here -->

    <!-- <div class="border-r"></div> -->
</div>
<!-- Procedures ends here -->

<ng-template #procContainer>
    <app-flypanel-procedure [taskId]="taskId" (TaskLinked)="getLinkedProcedures()"></app-flypanel-procedure>
</ng-template>