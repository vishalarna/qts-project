<app-spinner *ngIf="DataSource === undefined"></app-spinner>
<div *ngIf="DataSource !== undefined && showTool" class="p-4">
  <div class="flex flex-row justify-between items-center px-3 mt-4">
    <p class="text-xl font-bold text-gray-900">Edit {{("Tool" | labelReplacement)| async}}s</p>
    <app-button (clicked)="closed.emit('fp-edit-tools')" ButtonType='icon' icon="close">
    </app-button>
  </div>
  <div class="flex flex-row justify-between items-center px-3 mt-4">
    <p class="text-sm text-gray-500">{{DataSource.data.length}} Linked to selected Skill Qualification</p>
    <app-button (clicked)="showTool = false; linkTool = true;" variant="text" iconPosition="left" icon="link" text="Link {{('Tool' | labelReplacement)| async}}s">
    </app-button>

  </div>
  <div>
    <div class="flex flex-col flex-wrap bg-gray-one mb-3 mt-3  px-3 py-3 rounded" *ngIf="unlinkIds.length > 0">
      <div class="flex flex-row w-full justify-between mb-3">
        <p class="text-xs text-gray-four pt-2">{{unlinkIds.length}} {{("Tool" | labelReplacement)| async}}s selected</p>
        <app-button [disabled]="spinner" [spinner]="spinner" class="mb-2" type="button" color="secondary" size="sm"
          text="Unlink {{('Tool' | labelReplacement)| async}}s" (clicked)="unlinkItemsModal(unlinkToolsModal)">
        </app-button>
      </div>
    </div>
    <mat-table [dataSource]="DataSource" class="table-bordered ">
      <ng-container matColumnDef="id">
        <mat-header-cell *matHeaderCellDef>
          <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()">
          </mat-checkbox>
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selectrow(row) : null"
            [checked]="selection.isSelected(row)">
          </mat-checkbox>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef> Name
        </mat-header-cell>
        <mat-cell *matCellDef="let row">
          {{row.name}} </mat-cell>
      </ng-container>
      <mat-header-row *matHeaderRowDef="displayColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayColumns;"></mat-row>

      <!-- Row shown when there is no matching data.-->
      <tr class="mat-row flex text-center " *matNoDataRow>
        <td class="mat-cell w-full m-2">No data to display</td>
      </tr>

    </mat-table>
  </div>
</div>

<ng-container *ngIf="linkTool">
  <app-flypanel-eo-tool-link [eoId]="eoId" (closed)="linkTool = false;showTool = true;refreshTools();" [alreadyLinked]="alreadyLinked"></app-flypanel-eo-tool-link>
</ng-container>

<ng-template #unlinkToolsModal>
  <app-qtd-dialogue [header]="dialogTitle" [description]="dialogDesc" cancelText="No" confirmText="Yes"
    [showEffectiveDateAndReason]="true" (canceled)="dialog.closeAll()" (confirmed)="getDeleteData($event)">
  </app-qtd-dialogue>
</ng-template>
