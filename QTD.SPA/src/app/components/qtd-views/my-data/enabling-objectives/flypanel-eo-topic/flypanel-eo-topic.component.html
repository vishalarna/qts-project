<div [ngClass]="{'px-12 py-12':hasSpace}" class="flex flex-col">

  <div class="flex flex-row justify-between items-center mt-2">
    <p *ngIf="topic === undefined" class="text-xl font-bold text-gray-900">Add New Topic</p>
    <p *ngIf="topic !== undefined" class="text-xl font-bold text-gray-900">Edit Topic</p>
    <app-button [disabled]="showSpinner" (clicked)="closed.emit('fp-add-topic-closed')" ButtonType='icon' icon="close">
    </app-button>
  </div>

  <form class="flex flex-col" [formGroup]="topicForm">
    <div class="mt-3">
      <app-label [for]="'category'" text="Category " class="label required"></app-label>
      <mat-select [disabled]="topic !== undefined" formControlName="category" placeholder="Select Category"
        (selectionChange)="getCategories($event.value)" class="appearance-none rounded border w-full px-4 py-2.5 mt-2">
        <app-data-loader *ngIf="categoryLoader"></app-data-loader>
        <mat-option *ngFor="let d of categories" [value]="d.id" [hidden]="!d.active">
          {{d.number}} - {{d.title}}
        </mat-option>
      </mat-select>
      <app-input-error *ngIf="topicForm.get('category')?.invalid" text="Category is Required">
      </app-input-error>
    </div>

    <div class="mt-3">
      <app-label [for]="'subcategory'" text="Sub Category " class="label required"></app-label>
      <mat-select [disabled]="topic !== undefined" formControlName="subcategory" placeholder="Select Sub Category"
        (selectionChange)="getSubCategories($event.value)"
        class="appearance-none rounded border w-full px-4 py-2.5 mt-2" >
        <app-data-loader *ngIf="subCategoryLoader"></app-data-loader>
        <mat-option *ngFor="let d of subcategories" [value]="d.id" [hidden]="!d.active">
          {{d.number}} - {{d.title}}
        </mat-option>
      </mat-select>
      <app-input-error *ngIf="topicForm.get('subcategory')?.invalid" text="Sub Category is Required">
      </app-input-error>
    </div>

    <div class="mt-3">
      <app-label [for]="'number'" text="Topic Number " class="label required"></app-label>
      <!-- <app-textbox formControlName="number" [(ngModel)]="TopicNumber"></app-textbox> -->
      <app-textbox formControlName="number"></app-textbox>
      <app-input-error *ngIf="topicForm.get('number')?.invalid" text="Number is Required">
      </app-input-error>
    </div>
    <div class="mt-3">
      <app-label [for]="'title'" text="Topic Title "></app-label>
      <app-textbox formControlName="title" placeholder="Title"></app-textbox>
      <app-input-error *ngIf="topicForm.get('title')?.invalid || topicForm.get('title')?.hasError('whitespaceOnly')" text="Title Is Required Or Contains WhiteSpaces">
      </app-input-error>
    </div>
    <div class="mt-3">
      <app-label [for]="'desc'" text="Topic Description "></app-label>
      <app-textarea [value]="topicForm.get('desc')?.value ?? '' " formControlName="desc" type="text" placeholder="Please enter description here">
      </app-textarea>
      <!--  <app-textarea formControlName="desc" placeholder="Please enter description here">
            </app-textarea> -->
      <app-input-error *ngIf="topicForm.get('desc')?.invalid" text="Description is Required">
      </app-input-error>
    </div>
    <div class="mt-3">
      <app-label [for]="'effectiveDate'" text="Effective Date"></app-label>
      <app-date  formControlName="effectiveDate"></app-date>
    </div>
    <div class="mt-3">
      <app-label [for]="'reason'" text="Reason for Revision" class="label required"></app-label>
      <app-textarea [value]="topicForm.get('reason')?.value ?? '' " formControlName="reason" placeholder="Please enter Reasons for Revision here">
      </app-textarea>
      <app-input-error *ngIf="topicForm.get('reason')?.invalid || topicForm.get('reason')?.hasError('whitespaceOnly')" text="Reason for Revision is Required Or Contains WhiteSpaces">
      </app-input-error>
      <!--  <app-textarea formControlName="reason" placeholder="Please enter Reasons for Revision here">
            </app-textarea> -->
    </div>
    <div class="flex flex-row flex-grow justify-between pt-12">
      <div class="flex flex-row"  *ngIf="topic===undefined">
        <mat-checkbox formControlName="AddAnother" name="AddAnother"></mat-checkbox>
        <span class="ml-1">Add another Topic</span>
      </div>

      <div>
        <app-button [spinner]="showSpinner" *ngIf="topic === undefined" [disabled]="topicForm.invalid || showSpinner" (clicked)="saveTopic()" text="Save"
          size="sm"></app-button>
      </div>
    </div>

    <div class="flex flex-row-reverse">
      <app-button [spinner]="showSpinner" *ngIf="topic !== undefined" [disabled]="topicForm.invalid || showSpinner" (clicked)="updateTopic()" text="Update"
      size="sm"></app-button>
    </div>
  </form>
</div>
