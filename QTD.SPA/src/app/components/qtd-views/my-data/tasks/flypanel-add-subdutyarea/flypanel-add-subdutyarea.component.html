<div class="flex flex-col">

    <div class="flex flex-row justify-between items-center mt-2">
        <p *ngIf="oldSDA === undefined" class="text-xl font-bold text-gray-900">Add New Sub Duty Area</p>
        <p *ngIf="oldSDA !== undefined && !isCopy" class="text-xl font-bold text-gray-900">Edit Sub Duty Area</p>
        <p *ngIf="isCopy" class="text-xl font-bold text-gray-900">Copy Sub Duty Area</p>
        <app-button (clicked)="closed.emit('fp-add-SDA-closed')" ButtonType='icon' icon="close">
        </app-button>
    </div>

    <form class="flex flex-col" [formGroup]="SubDutyAreaForm">
        <div class="flex-col mt-3">
            <div class="flex flex-row justify-between">
                <app-label [for]="'dutyAreaId'" [text]="'Duty Area'"></app-label>
            </div>
            <mat-select formControlName="dutyAreaId" placeholder="Select Duty Area"
                (selectionChange)="getSubDutyAreaNumber($event.value)"
                class="appearance-none rounded border w-full px-4 py-2.5 mt-2">
                <mat-option *ngFor="let d of dutyAreas" [value]="d.id"  [hidden]="!d.active">
                    {{d.letter}} {{d.number}} - {{d.title}}
                </mat-option>
            </mat-select>
            <app-input-error *ngIf="SubDutyAreaForm.get('dutyAreaId')?.invalid" text="DutyArea is Required">
            </app-input-error>
        </div>
        <div class="mt-3">
            <app-label [for]="'number'" text="Sub Duty Area Number"></app-label>
            <app-textbox formControlName="number" type="number" placeholder="Sub Duty Area Number"></app-textbox>
            <app-input-error *ngIf="SubDutyAreaForm.get('number')?.invalid" text="Number is Required">
            </app-input-error>
        </div>
        <div class="mt-3">
            <app-label [for]="'title'" text="Sub Duty Area Title"></app-label>
            <app-textarea  [value]="SubDutyAreaForm.get('title')?.value ?? '' " formControlName="title" placeholder="Title"></app-textarea>
            <app-input-error *ngIf="SubDutyAreaForm.get('title')?.invalid || SubDutyAreaForm.get('title')?.hasError('whitespaceOnly')" text="Title is Required Or Contains WhiteSpaces">
            </app-input-error>
        </div>
        <div class="mt-3">
            <app-label [for]="'desc'" text="Sub Duty Area Description"></app-label>
            <app-textarea formControlName="desc" placeholder="Please enter description here"
                [value]="SubDutyAreaForm.get('desc')?.value || ''">
            </app-textarea>
        </div>
        <div class="mt-3">
            <app-label [for]="'effectiveDate'" text="Effective Date"></app-label>
            <app-date formControlName="effectiveDate"></app-date>
            <!-- <app-input-error text="Enter Valid Effective Date Greater then or equal to current Date" *ngIf="dateError">
            </app-input-error> -->
        </div>
        <div class="mt-3">
            <app-label [for]="'reason'" text="Reason for Revision " class="label required"></app-label>
            <app-textarea formControlName="reason" [value]="SubDutyAreaForm.get('reason')?.value || ''"
                placeholder="Please enter Reasons for Revision here">
            </app-textarea>
            <app-input-error *ngIf="SubDutyAreaForm.get('reason')?.invalid || SubDutyAreaForm.get('reason')?.hasError('whitespaceOnly')" text="Reason for Revision is Required Or Contains WhiteSpaces">
            </app-input-error>
        </div>
        <div class="flex flex-row flex-grow justify-between pt-12">
            <mat-checkbox *ngIf="oldSDA === undefined" formControlName="AddAnother">Add another Sub Duty area</mat-checkbox>
            <!-- <app-button [disabled]="SubDutyAreaForm.invalid || dateError" (clicked)="saveSubDutyArea()" text="Save"
                size="sm"></app-button> -->

            <app-button [spinner]="showSpinner" *ngIf="oldSDA === undefined" [disabled]="SubDutyAreaForm.invalid  || showSpinner"
                (clicked)="saveSubDutyArea()" text="Save" size="sm">
            </app-button>
        </div>

        <div class="flex flex-row-reverse">
            <app-button [spinner]="showSpinner" *ngIf="oldSDA !== undefined && !isCopy"
            [disabled]="SubDutyAreaForm.invalid  || showSpinner" (clicked)="editSubDutyArea()" text="Update"
            size="sm">
            </app-button>
            <app-button [spinner]="showSpinner" *ngIf="isCopy" [disabled]="SubDutyAreaForm.invalid || showSpinner"
                (clicked)="saveSubDutyArea()" text="Copy" size="sm">
            </app-button>
        </div>
    </form>
</div>
